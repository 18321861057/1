<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/ErpSystem.css" />
		<script src="js/jquery-2.1.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			$(function() {
				newTab();
				newTabs();
				other();
			});
			//主页点击子公司
			function newTab() {
				//主页子公司的点击
				$("#SystemLists_ul li").on({
					click:function(){
						var url = $(this).data("url");
						var ele_frame = $("<iframe data-id='" + url + "' src='" + url + "'></iframe>");
						var ele_li = $("<li class='active' name='" + url + "' ><span>" + $(this).find('p').text() + "</span><i></i></li>");
						//第一次点击
						if(!$(this).hasClass("open")) {
							$(this).addClass("open")
							$(".SystemLists").hide();
							$(".SystemIframe").append(ele_frame);
							$("#SystemMenu_ul_list").append(ele_li);
							var scollWidth = $(".SystemList_main").width() - 28;
							var sun = 0;
							$("#SystemMenu_ul_list li").each(function() {
								sun += $(this).outerWidth();
							});
							var changW = -(sun - scollWidth - 14) + "px";
							if(scollWidth < sun) {
								$("#SystemMenu_ul_list").animate({
									left: changW
								}, 1000)
							}
							$(".never").removeClass("active");
						} else {
							$(".SystemIframe iframe").each(function() {
								if($(this).data("id") == url) {
									$(".SystemLists").hide();
									$(this).show().siblings().hide();
								}
							})
							$("#SystemMenu_ul_list li").each(function() {
								if($(this).attr("name") == url) {
									$(this).addClass("active").siblings().removeClass("active");
									var a = $(this).offset().left;
									var b = $(".SystemList_main").offset().left;
									var c = $(".SystemList_main").width();
									if(a - b > c) {
										$("#SystemMenu_ul_list").animate({
											left: -(a - c) + "px"
										}, 1000);
									}
								}
							})
	
						}
						changeTab();
					},
					//移入弹出内容框
					mouseover :function(){
						var liTop = $(this).offset().top;
						var liLeft = $(this).offset().left+$(this).outerWidth();
						if(liLeft+$(this).outerWidth()+$(".remind").width()<$(Window).width()){
							$(".remind").css({"top":liTop,"left":liLeft}).show();
						}else{
							$(".remind").css({"top":liTop,"left":liLeft-$(this).outerWidth()-$(".remind").width()}).show();
						}
					},
					//移出隐藏
					mouseout :function(){
					 	$(".remind").hide();
					}
				});
			}
			function newTabs() {
				//主页子公司的点击
				$("#SystemLists_tab tr").on({
					click:function(){
						var url = $(this).data("url");
						var ele_frame = $("<iframe data-id='" + url + "' src='" + url + "'></iframe>");
						var ele_li = $("<li class='active' name='" + url + "' ><span>" + $(this).find("td").eq(1).text() + "</span><i></i></li>");
						//第一次点击
						if(!$(this).hasClass("open")) {
							$(this).addClass("open")
							$(".SystemLists").hide();
							$(".SystemIframe").append(ele_frame);
							$("#SystemMenu_ul_list").append(ele_li);
							var scollWidth = $(".SystemList_main").width() - 28;
							var sun = 0;
							$("#SystemMenu_ul_list li").each(function() {
								sun += $(this).outerWidth();
							});
							var changW = -(sun - scollWidth - 14) + "px";
							if(scollWidth < sun) {
								$("#SystemMenu_ul_list").animate({
									left: changW
								}, 1000)
							}
							$(".never").removeClass("active");
						} else {
							$(".SystemIframe iframe").each(function() {
								if($(this).data("id") == url) {
									$(".SystemLists").hide();
									$(this).show().siblings().hide();
								}
							})
							$("#SystemMenu_ul_list li").each(function() {
								if($(this).attr("name") == url) {
									$(this).addClass("active").siblings().removeClass("active");
									var a = $(this).offset().left;
									var b = $(".SystemList_main").offset().left;
									var c = $(".SystemList_main").width();
									if(a - b > c) {
										$("#SystemMenu_ul_list").animate({
											left: -(a - c) + "px"
										}, 1000);
									}
								}
							})
	
						}
						changeTab();
					},
					//移入弹出内容框
					mouseover :function(){
						var liTop = $(this).offset().top;
						if(liTop+$(this).height()+$(".remind").height()<$(window).height()){
							$(".remind").css({"top":liTop+$(this).height()/2,"left":"100px"}).show();
						}else{
							$(".remind").css({"top":liTop-$(".remind").height()+$(this).height()/2,"left":"100px"}).show();
						}
					},
					//移出隐藏
					mouseout :function(){
					 	$(".remind").hide();
					}
				});
			}

			//
			function other() {
				//禁用右键的点击事件
				$("#SystemMenu_ul_list").bind("contextmenu", function() {
						return false;
					})
					//主页选项卡的点击(和新增的选项卡tab不一样)
				$(".never").on('click', function() {
					$(this).addClass("active").siblings().removeClass("active");
					$(".SystemLists").show();
					$(".SystemIframe iframe").hide();
				});
				//菜单的点击
				$(".SystemMenu_list").on("click", function() {
						if($(".Menu_list").css("display") == "none") {
							$(".Menu_list").slideDown();
						} else {
							$(".Menu_list").slideUp();
						}
					})
					//
				$(".Menu_list").on("mouseleave", function() {
					$(this).slideUp();
				})

				//选项卡Tab左滚动
				$(".SystemList_left").on("click", function() {
						var scollWidth = $(".SystemList_main").width() - 28;
						var ul_li = $("#SystemMenu_ul_list li");
						var sun = 0;
						$("#SystemMenu_ul_list li").each(function() {
							sun += $(this).outerWidth();
						});
						if(scollWidth < sun + 14) {
							$("#SystemMenu_ul_list").animate({
								left: "28px"
							}, 1000)
						}
					})
					//选项卡Tab右滚动
				$(".SystemList_Right").on("click", function() {
					var scollWidth = $(".SystemList_main").width() - 28;
					var sun = 0;
					$("#SystemMenu_ul_list li").each(function() {
						sun += $(this).outerWidth();
					});
					var changW = -(sun - scollWidth) + "px";
					if(scollWidth < sun) {
						$("#SystemMenu_ul_list").animate({
							left: changW
						}, 1000)
					}
				})
			}
			//选项卡Tab的切换
			function changeTab() {
				$(".tabs_menu li").each(function() {
						$(this).unbind("click").click(function() {
							var that = $(this).data("idx");
							switch(this.id) {
								case "refresh":
									refresh(that);
									break;
								case "closethis":
									closethis(that);
									break;
								case "closeall":
									closeall();
									break;
								case "closeallnotthis":
									closeallnotthis(that);
									break;
								case "exsit":
									exsit();
									break;
							}
						})
					})
					//切换选项卡Tab
				$("#SystemMenu_ul_list li:not(:first)").unbind().on({
					click: function() {
						var index = $(this).index();
						$(this).addClass("active").siblings().removeClass("active");
						$(".SystemLists").hide();
						$(".SystemIframe iframe").eq(index - 1).show().siblings().hide();
					},
					//为菜单下选项卡添加鼠标右击事件
					mousedown: function(e) {
						//3为鼠标右键
						if(3 == e.which) {
							var indexname = $(this).attr("name");
							var neverLeft = $(".never").offset().left;
							var ulLeft = $(this).offset().left;
							var ulHeight = $(this).height();
							$(".tabs_menu").css({
								"top": ulHeight,
								"left": ulLeft - neverLeft,
								"display": "block"
							})
							$(".tabs_menu li").data("idx", indexname);
						}
					},
					//鼠标双击关闭当前选项卡Tab
					dblclick: function() {
						$(this).find("i").click();
					}
				});
				closeTab();
			}
			//关闭选项卡Tab
			function closeTab() {
				//关闭选项卡Tab
				$("#SystemMenu_ul_list i").unbind().on("click", function() {
					$(".SystemLists").hide();
					var closeUrl = $(this).parent().attr("name");
					$(this).parent().remove();
					$("#SystemMenu_ul_list li").length == 1 && ($(".SystemLists").show());
					$("#SystemMenu_ul_list li").length == 2 && ($("#SystemMenu_ul_list").animate({
						left: "28px"
					}, 1000));
					$("#SystemMenu_ul_list li").removeClass("active");
					$("#SystemMenu_ul_list li:last").addClass("active");

					$(".SystemIframe iframe").each(function() {
						var fname = $(this).data("id");
						if(fname == closeUrl) {
							$(this).remove();
							$(".SystemIframe iframe:last").show().siblings().hide();
						}
					})

					$(".SystemLists ul li").each(function() {
						var liUrl = $(this).data("url");
						if(liUrl == closeUrl) {
							$(this).removeClass("open");
						}
					});
					$(".open").each(function() {
						var openUrl = $(this).data("url");
						if(openUrl == closeUrl) {
							$(this).removeClass("open");
						}
					})
				})
			}
			//刷新当前
			function refresh(that) {
				var refresh = $("#SystemMenu_ul_list").find(".active").attr("name");
				var target = $(".SystemIframe iframe[data-id='" + refresh + "']");
				var url = target.attr('src');
				target.attr('src', url).load(function() {
					//$.loading(false);
				});
				$(".tabs_menu").hide();
			}
			//关闭全部
			function closeall() {
				$("#SystemMenu_ul_list li:not(:first)").find("i").click();
				$(".tabs_menu").hide();
			}
			//关闭当前
			function closethis(that) {
				$("#SystemMenu_ul_list li[name='" + that + "']").find("i").click();
				$(".tabs_menu").hide();
			}
			//除此之外全部关闭
			function closeallnotthis(that) {
				$("#SystemMenu_ul_list li[name='" + that + "']").siblings().not(".never").find("i").click();
				$(".tabs_menu").hide();
			}
			//取消
			function exsit() {
				$(".tabs_menu").hide();
			}
			//添加新的tab选项卡
			function addTab(obj, subtitle, url) {
				var ele_frame = $("<iframe data-id='" + url + "' src='" + url + "'></iframe>");
				var ele_li = $("<li class='active' name='" + url + "' ><span>" + subtitle + "</span><i></i></li>");
				if(!$(obj).hasClass("open")) {
					$(obj).addClass("open");
					$(".SystemLists").hide();
					$(".SystemIframe").append(ele_frame);
					$("#SystemMenu_ul_list").append(ele_li);
					$(".SystemIframe iframe").each(function() {
						if($(this).data("id") == url) {
							$(this).show().siblings().hide();
						}
					})
					$("#SystemMenu_ul_list li").each(function() {
						if($(this).attr("name") == url) {
							$(this).addClass("active").siblings().removeClass("active");
						}
					})
					var scollWidth = $(".SystemList_main").width() - 28;
					var sun = 0;
					$("#SystemMenu_ul_list li").each(function() {
						sun += $(this).outerWidth();
					});
					var changW = -(sun - scollWidth - 14) + "px";
					if(scollWidth < sun) {
						$("#SystemMenu_ul_list").animate({
							left: changW
						}, 1000)
					}
					$(".never").removeClass("active");
				} else {
					$(".SystemIframe iframe").each(function() {
						if($(this).data("id") == url) {
							$(".SystemLists").hide();
							$(this).show().siblings().hide();
						}
					})
					$("#SystemMenu_ul_list li").each(function() {
						if($(this).attr("name") == url) {
							$(this).addClass("active").siblings().removeClass("active");
							var a = $(this).offset().left;
							var b = $(".SystemList_main").offset().left;
							var c = $(".SystemList_main").width();
							if(a - b > c) {
								$("#SystemMenu_ul_list").animate({
									left: -(a - c) + "px"
								}, 1000);
							}
						}
					})
				}
				changeTab();
			}
			//大图和列表的显示切换
			function changelist() {
				var vs = $('select option:selected').val();
				if(vs == "pic") {
					$("#SystemLists_ul").show().next("#SystemLists_tab").hide();
				} else {
					$("#SystemLists_tab").show().prev("#SystemLists_ul").hide();
				}
			}
		</script>
	</head>

	<body>
		<div class="ErpSystem">
			<div class="SystemHead">
				<div class="SystemCom">
					ERP子系统
				</div>
				<div class="SystemMenu">
					<span>系统管理员</span>
					<span class="SystemMenu_list">菜单</span>
					<span>退出</span>
					<div class="Menu_list">
						<ul class="ul_tabs">
							<li>用户设置</li>
							<li data-url="mainchil.html" onclick="addTab(this,'权限设置','mainchil.html')">权限设置</li>
							<li data-url="mainmenu.html" onclick="addTab(this,'子系统管理','mainmenu.html')">子系统设置</li>
						</ul>
					</div>
				</div>
				<div class="SystemList">
					<div class="SystemList_main">
						<ul id="SystemMenu_ul_list">
							<li class="never"><span>主页</span></li>
						</ul>
						<div class="SystemList_Right"> > </div>
						<div class="SystemList_left">
							< </div>
						</div>

						<div class="tabs_menu">
							<ol>
								<li id="refresh" data-idx="">刷新当前</li>
								<li id="closethis" data-idx="">关闭当前</li>
								<li id="closeall">全部关闭</li>
								<li id="closeallnotthis" data-idx="">除此之外全部关闭</li>
								<li id="exsit">取消</li>
							</ol>
						</div>
					</div>
				</div>
				<div class="SystemMain">
					<div class="SystemLists">
						<div class="SystemLists_search">
							<span><input type="text" /></span>
							<span class="search">查询</span>
							<span>
								<select name="" id="" onchange="changelist()">
									<option value="pic">大图</option>
									<option value="list">列表</option>
								</select>
							</span>
						</div>
						<div class="SystemLists_company">
							<ul id="SystemLists_ul" style="display: block;">
								<li data-url="main1.html">
									<div>
										<span><img src="images/logo32.png"/></span>
									</div>
									<p class="">上海公司</p>
								</li>
								<li data-url="main2.html">
									<div>
										<span><img src="images/zhzhuanglogo.png"/></span>
									</div>
									<p class="">南京可贷款分公司</p>
								</li>
								<li data-url="main3.html">
									<div></div>
									<p class="">杭州分公司的感觉</p>
								</li>
								<li data-url="main4.html">
									<div></div>
									<p class="">北京分公司不多看</p>
								</li>
								<li data-url="main5.html">
									<div></div>
									<p class="">合肥分公脑卡的看</p>
								</li>
								<li data-url="main6.html">
									<div></div>
									<p class="">青岛分公司到款</p>
								</li>
								<li data-url="main7.html">
									<div></div>
									<p class="">温州分公司都拿卡了</p>
								</li>
								<li data-url="main8.html">
									<div></div>
									<p class="">武汉分公司</p>
								</li>
								<li data-url="main9.html">
									<div></div>
									<p class="">九江分公司</p>
								</li>
								<li data-url="main8.html">
									<div></div>
									<p class="">武汉分公司</p>
								</li>
								<li data-url="main9.html">
									<div></div>
									<p class="">九江分公司</p>
								</li>
								<li data-url="main8.html">
									<div></div>
									<p class="">武汉分公司</p>
								</li>
								<li data-url="main9.html">
									<div></div>
									<p class="">九江分公司</p>
								</li>
								<li data-url="main8.html">
									<div></div>
									<p class="">武汉分公司</p>
								</li>
								<li data-url="main1.html">
									<div>
										<!--<img src="images/wenjian5.png"/>-->
									</div>
									<p class="">上海公司</p>
								</li>
								<li data-url="main2.html">
									<div></div>
									<p class="">南京大分公司</p>
								</li>
								<li data-url="main3.html">
									<div></div>
									<p class="">杭州分公司的感觉</p>
								</li>
								<li data-url="main4.html">
									<div></div>
									<p class="">北京分公司不多看</p>
								</li>
							</ul>
							<div id="SystemLists_tab" style="display: none;">
								<table border="0" cellspacing="0" cellpadding="0">
									<thead>
										<tr>
											<th>编号</th>
											<th>名称</th>
											<th>地址</th>
											<th>城市</th>
											<th>logo</th>
										</tr>
									</thead>
									<tbody>
										<tr data-url="main2.html">
											<td>101</td>
											<td>上海家园分公司</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main3.html">
											<td>101</td>
											<td>武汉</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main4.html">
											<td>101</td>
											<td>合肥</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main5.html">
											<td>101</td>
											<td>九江</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main6.html">
											<td>101</td>
											<td>杭州</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main7.html">
											<td>101</td>
											<td>北京</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main5.html">
											<td>101</td>
											<td>九江</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main6.html">
											<td>101</td>
											<td>杭州</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main7.html">
											<td>101</td>
											<td>北京</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main5.html">
											<td>101</td>
											<td>九江</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main6.html">
											<td>101</td>
											<td>杭州</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main7.html">
											<td>101</td>
											<td>北京</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main5.html">
											<td>101</td>
											<td>九江</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main6.html">
											<td>101</td>
											<td>杭州</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main7.html">
											<td>101</td>
											<td>北京</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main5.html">
											<td>101</td>
											<td>九江</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main6.html">
											<td>101</td>
											<td>杭州</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main7.html">
											<td>101</td>
											<td>北京</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main5.html">
											<td>101</td>
											<td>九江</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main6.html">
											<td>101</td>
											<td>杭州</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
										<tr data-url="main7.html">
											<td>101</td>
											<td>北京</td>
											<td>上海市徐汇区国展家园</td>
											<td>上海</td>
											<td>LOGO</td>
										</tr>
									</tbody>
								</table>
							</div>
							<div class="page">
								<span>上一页</span>
								<span>下一页</span>
							</div>
						</div>
						<div class="remind">
							<ul>
								<li>
									量房数量：<span>50</span>套
								</li>
								<li>
									设计金额：<span>40</span>万
								</li>
								<li>
									施工金额：<span>50</span>万
								</li>
								<li>
									本月开工：<span>50</span>套
								</li>
								<li>
									本月竣工：<span>50</span>套
								</li>
								<li>
									本月投诉：<span>50</span>起
								</li>
								<li>
									主材销售：<span>50</span>万
								</li>
								<li>
									入职人员：<span>50</span>人
								</li>
								<li>
									离职人员：<span>50</span>人
								</li>
							</ul>
						</div>
					</div>
					<div class="SystemIframe">
						<!--<iframe src="main1.html" ></iframe>-->
					</div>
				</div>
			</div>
	</body>

</html>